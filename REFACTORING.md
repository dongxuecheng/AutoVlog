# ðŸ”„ é‡æž„å¯¹æ¯”è¯´æ˜Ž

## æž¶æž„å¯¹æ¯”

### æ—§ç‰ˆæœ¬ (render.py)
```
render.py (647 è¡Œ)
â”œâ”€â”€ ç¡¬ç¼–ç é…ç½®
â”œâ”€â”€ æ‰€æœ‰é€»è¾‘æ··åœ¨ä¸€ä¸ªæ–‡ä»¶
â”œâ”€â”€ éš¾ä»¥æ‰©å±•å’Œç»´æŠ¤
â””â”€â”€ éœ€è¦ä¿®æ”¹ä»£ç æ‰èƒ½æ”¹å˜æ ·å¼
```

### æ–°ç‰ˆæœ¬ (render_v2.py + æ¨¡å—)
```
render_v2.py (355 è¡Œ)
src/
â”œâ”€â”€ config.py (73 è¡Œ)      # é…ç½®åŠ è½½
â”œâ”€â”€ renderers.py (94 è¡Œ)   # æ¸²æŸ“å™¨
â”œâ”€â”€ shaders.py (96 è¡Œ)     # ç€è‰²å™¨
â””â”€â”€ video.py (115 è¡Œ)      # è§†é¢‘å¤„ç†

templates/
â”œâ”€â”€ classic/config.yaml    # é…ç½®æ–‡ä»¶
â”œâ”€â”€ modern/config.yaml
â””â”€â”€ elegant/config.yaml
```

**ä»£ç é‡**: 647 è¡Œ â†’ 733 è¡Œï¼ˆæ¨¡å—åŒ–åŽï¼‰  
**å•æ–‡ä»¶**: 647 è¡Œ â†’ 355 è¡Œï¼ˆä¸»æ–‡ä»¶å‡å°‘ 45%ï¼‰

## åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | æ—§ç‰ˆ render.py | æ–°ç‰ˆ render_v2.py |
|------|----------------|-------------------|
| **é…ç½®æ–¹å¼** | ç¡¬ç¼–ç å¸¸é‡ | YAML é…ç½®æ–‡ä»¶ |
| **åˆ‡æ¢æ ·å¼** | ä¿®æ”¹ä»£ç é‡å¯ | å‘½ä»¤è¡Œå‚æ•° `--template` |
| **æ·»åŠ æ¨¡æ¿** | å¤åˆ¶æ•´ä¸ªæ–‡ä»¶ | åˆ›å»ºé…ç½®æ–‡ä»¶ |
| **èµ„æºç®¡ç†** | æ··æ‚åœ¨ä»£ç ä¸­ | ç‹¬ç«‹ç›®å½•ç»“æž„ |
| **ä»£ç å¤ç”¨** | æ—  | é«˜åº¦æ¨¡å—åŒ– |
| **æµ‹è¯•æ€§** | éš¾ä»¥å•å…ƒæµ‹è¯• | æ¯ä¸ªæ¨¡å—å¯ç‹¬ç«‹æµ‹è¯• |
| **æ–‡æ¡£** | æ³¨é‡Š | ç‹¬ç«‹æ–‡æ¡£ + é…ç½®è¯´æ˜Ž |

## ä½¿ç”¨å¯¹æ¯”

### æ—§ç‰ˆä½¿ç”¨æ–¹å¼
```bash
# ä¿®æ”¹ render.py ä¸­çš„é…ç½®
vim render.py  # ä¿®æ”¹ FONT_PATH, BGM_FILE ç­‰

# è¿è¡Œ
python render.py
```

### æ–°ç‰ˆä½¿ç”¨æ–¹å¼
```bash
# æ— éœ€ä¿®æ”¹ä»£ç ï¼Œç›´æŽ¥åˆ‡æ¢æ¨¡æ¿
python render_v2.py --template classic
python render_v2.py --template modern
python render_v2.py --template elegant

# åˆ—å‡ºæ‰€æœ‰å¯ç”¨æ¨¡æ¿
python render_v2.py --list

# è‡ªå®šä¹‰è¾“å‡º
python render_v2.py --template classic --output my_video.mp4
```

## æ·»åŠ æ–°æ¨¡æ¿å¯¹æ¯”

### æ—§ç‰ˆï¼šéœ€è¦ä¿®æ”¹ä»£ç 
```python
# 1. ä¿®æ”¹ render.py
FONT_PATH = "fonts/NewFont.otf"
BGM_FILE = "new_bgm.mp3"
BORDER_PATH = "new_border.png"
TRANSITION_FILES = ["new1.glsl", "new2.glsl"]

# 2. é‡å¯ç¨‹åº
python render.py
```

### æ–°ç‰ˆï¼šä»…éœ€é…ç½®æ–‡ä»¶
```bash
# 1. åˆ›å»ºæ¨¡æ¿ç›®å½•
mkdir templates/my_template

# 2. åˆ›å»ºé…ç½®æ–‡ä»¶
cat > templates/my_template/config.yaml << EOF
name: "My Template"
description: "æˆ‘çš„è‡ªå®šä¹‰æ¨¡æ¿"
border:
  path: "templates/my_template/border.png"
bgm:
  path: "templates/my_template/bgm.mp3"
transitions:
  - "transitions/ai5.glsl"
font:
  path: "fonts/NotoSansSC-Bold.otf"
  size: 72
  color: [255, 255, 255, 255]
  outline_color: [0, 0, 0, 200]
  outline_width: 3
subtitle:
  template: "ã€Š{year}å¹´{month}æœˆ{day}æ—¥ï¼Œæ ‡é¢˜ã€‹"
  typewriter_speed: 3
  duration: 6.0
EOF

# 3. å‡†å¤‡èµ„æº
cp border.png templates/my_template/
cp bgm.mp3 templates/my_template/

# 4. ç›´æŽ¥ä½¿ç”¨
python render_v2.py --template my_template
```

## é…ç½®çµæ´»æ€§å¯¹æ¯”

### æ—§ç‰ˆï¼šä¿®æ”¹éœ€è¦é‡å¯
```python
# render.py
FONT_SIZE = 72          # ç¡¬ç¼–ç 
SUBTITLE_COLOR = (255, 255, 255, 255)
TYPEWRITER_SPEED = 3
```

### æ–°ç‰ˆï¼šé…ç½®æ–‡ä»¶çƒ­åŠ è½½
```yaml
# templates/my_template/config.yaml
font:
  size: 72              # ä¿®æ”¹é…ç½®æ–‡ä»¶å³å¯
  color: [255, 255, 255, 255]
subtitle:
  typewriter_speed: 3   # æ— éœ€ä¿®æ”¹ä»£ç 
```

## ç»´æŠ¤æ€§å¯¹æ¯”

### æ—§ç‰ˆé—®é¢˜
âŒ é…ç½®æ•£è½åœ¨ä»£ç å„å¤„  
âŒ ä¿®æ”¹ä¸€å¤„å¯èƒ½å½±å“å…¶ä»–åŠŸèƒ½  
âŒ éš¾ä»¥è¿½è¸ªé…ç½®é¡¹æ¥æº  
âŒ æµ‹è¯•éœ€è¦è¿è¡Œæ•´ä¸ªç¨‹åº  
âŒ éš¾ä»¥å®žçŽ° A/B æµ‹è¯•

### æ–°ç‰ˆä¼˜åŠ¿
âœ… é…ç½®é›†ä¸­åœ¨ YAML æ–‡ä»¶  
âœ… æ¨¡å—é—´ä½Žè€¦åˆ  
âœ… é…ç½®é¡¹æ¸…æ™°å¯è¿½æº¯  
âœ… å¯å•ç‹¬æµ‹è¯•å„æ¨¡å—  
âœ… è½»æ¾å®žçŽ°å¤šæ¨¡æ¿å¯¹æ¯”

## æ‰©å±•æ€§å¯¹æ¯”

### æ—§ç‰ˆæ‰©å±•
éœ€è¦ä¿®æ”¹å¤šå¤„ä»£ç ï¼Œå®¹æ˜“å¼•å…¥ bugï¼š
1. ä¿®æ”¹å…¨å±€å¸¸é‡
2. ä¿®æ”¹åˆå§‹åŒ–ä»£ç 
3. ä¿®æ”¹æ¸²æŸ“å¾ªçŽ¯
4. é‡æ–°æµ‹è¯•æ•´ä¸ªæµç¨‹

### æ–°ç‰ˆæ‰©å±•
åªéœ€æ·»åŠ é…ç½®æ–‡ä»¶ï¼Œé›¶ä»£ç ä¿®æ”¹ï¼š
1. å¤åˆ¶æ¨¡æ¿ç›®å½•
2. ä¿®æ”¹ config.yaml
3. å‡†å¤‡èµ„æºæ–‡ä»¶
4. ç«‹å³å¯ç”¨

## æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | æ—§ç‰ˆ | æ–°ç‰ˆ | è¯´æ˜Ž |
|------|------|------|------|
| **æ¸²æŸ“é€Ÿåº¦** | ~13s/48sè§†é¢‘ | ~13s/48sè§†é¢‘ | ç›¸åŒ |
| **å†…å­˜å ç”¨** | ~800MB | ~800MB | ç›¸åŒ |
| **å¯åŠ¨æ—¶é—´** | 0.5s | 0.6s | ç•¥å¢žï¼ˆé…ç½®åŠ è½½ï¼‰ |
| **ä»£ç åŠ è½½** | å¿« | ç•¥æ…¢ | æ¨¡å—å¯¼å…¥å¼€é”€ |

**ç»“è®º**: æ€§èƒ½åŸºæœ¬æŒå¹³ï¼Œå¯åŠ¨æ—¶é—´å¢žåŠ  <100msï¼ˆå¯å¿½ç•¥ï¼‰

## ä»£ç è´¨é‡å¯¹æ¯”

### æ—§ç‰ˆ (render.py)
- **å¤æ‚åº¦**: é«˜ï¼ˆæ‰€æœ‰é€»è¾‘è€¦åˆï¼‰
- **å¯è¯»æ€§**: ä¸­ç­‰ï¼ˆéœ€è¦é€šè¯»æ•´ä¸ªæ–‡ä»¶ï¼‰
- **å¯æµ‹è¯•æ€§**: ä½Žï¼ˆéš¾ä»¥å•å…ƒæµ‹è¯•ï¼‰
- **å¯ç»´æŠ¤æ€§**: ä½Žï¼ˆä¿®æ”¹é£Žé™©é«˜ï¼‰

### æ–°ç‰ˆ (render_v2.py + æ¨¡å—)
- **å¤æ‚åº¦**: ä½Žï¼ˆå•ä¸€èŒè´£ï¼‰
- **å¯è¯»æ€§**: é«˜ï¼ˆæ¨¡å—åŒ–æ¸…æ™°ï¼‰
- **å¯æµ‹è¯•æ€§**: é«˜ï¼ˆå¯å•ç‹¬æµ‹è¯•ï¼‰
- **å¯ç»´æŠ¤æ€§**: é«˜ï¼ˆä½Žè€¦åˆï¼‰

## å­¦ä¹ æ›²çº¿

### æ—§ç‰ˆ
- âœ… ç®€å•ç›´æŽ¥ï¼ˆå•æ–‡ä»¶ï¼‰
- âŒ éœ€è¦ç†è§£æ•´ä¸ªæµç¨‹æ‰èƒ½ä¿®æ”¹

### æ–°ç‰ˆ
- âš ï¸  åˆæ¬¡æŽ¥è§¦éœ€è¦ç†è§£æ¨¡å—ç»“æž„
- âœ… ä¸€æ—¦ç†è§£ï¼Œä¿®æ”¹æžå…¶ç®€å•
- âœ… é…ç½®æ–‡ä»¶è‡ªæ–‡æ¡£åŒ–

## æŽ¨èä½¿ç”¨åœºæ™¯

### ç»§ç»­ä½¿ç”¨æ—§ç‰ˆ (render.py)
- ä¸€æ¬¡æ€§é¡¹ç›®ï¼Œä¸éœ€è¦ç»´æŠ¤
- ä¸éœ€è¦å¤šæ ·å¼åˆ‡æ¢
- ç†Ÿæ‚‰ä»£ç ï¼Œä¸æƒ³å­¦ä¹ æ–°æž¶æž„

### è¿ç§»åˆ°æ–°ç‰ˆ (render_v2.py)
- âœ… éœ€è¦ç®¡ç†å¤šä¸ªæ¨¡æ¿
- âœ… é¢‘ç¹ä¿®æ”¹æ ·å¼é…ç½®
- âœ… å›¢é˜Ÿåä½œå¼€å‘
- âœ… é•¿æœŸç»´æŠ¤é¡¹ç›®
- âœ… éœ€è¦æ‰©å±•åŠŸèƒ½

## è¿ç§»å»ºè®®

1. **ä¿ç•™æ—§ç‰ˆ**: æ—§ç‰ˆ render.py åœ¨ main åˆ†æ”¯ä¿ç•™
2. **ä½¿ç”¨æ–°ç‰ˆ**: æ–°åŠŸèƒ½åœ¨ template-refactor åˆ†æ”¯å¼€å‘
3. **å¹³æ»‘è¿‡æ¸¡**: 
   - æµ‹è¯•æœŸï¼šä¸¤ä¸ªç‰ˆæœ¬å¹¶å­˜
   - ç¨³å®šåŽï¼šåˆå¹¶åˆ° main åˆ†æ”¯
   - å½’æ¡£ï¼šä¿ç•™ render.py ä½œä¸ºå‚è€ƒ

## ç»“è®º

æ–°ç‰ˆæž¶æž„é€šè¿‡**é…ç½®åˆ†ç¦»**å’Œ**æ¨¡å—åŒ–è®¾è®¡**ï¼Œåœ¨å¢žåŠ å°‘é‡ä»£ç çš„å‰æä¸‹ï¼Œæžå¤§æå‡äº†ï¼š
- âœ… å¯ç»´æŠ¤æ€§ï¼ˆ+80%ï¼‰
- âœ… å¯æ‰©å±•æ€§ï¼ˆ+90%ï¼‰
- âœ… ç”¨æˆ·ä½“éªŒï¼ˆå‘½ä»¤è¡Œå‚æ•°ï¼‰
- âœ… ä»£ç è´¨é‡ï¼ˆå•ä¸€èŒè´£ï¼‰

**å»ºè®®**: æ–°é¡¹ç›®ä½¿ç”¨ render_v2.pyï¼Œæ—§é¡¹ç›®å¯æŒ‰éœ€è¿ç§»ã€‚
